<!DOCTYPE html>


  <html class="light page-post">


<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>Java Multithreading | Xfan blog</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="JAVA,">
  

  <meta name="description" content="date: 2018-02-08 14:20:32 Description Thread: Each part of the program is called one Threads, and each thread defines an independent execution path.Multithreading is a special form of multitasking. Mu">
<meta name="keywords" content="JAVA">
<meta property="og:type" content="article">
<meta property="og:title" content="Java Multithreading">
<meta property="og:url" content="https://feifaninternet.github.io/2019/04/11/Java-Multithreading/index.html">
<meta property="og:site_name" content="Xfan blog">
<meta property="og:description" content="date: 2018-02-08 14:20:32 Description Thread: Each part of the program is called one Threads, and each thread defines an independent execution path.Multithreading is a special form of multitasking. Mu">
<meta property="og:locale" content="Chinese">
<meta property="og:image" content="https://feifaninternet.github.io/picture/ThreadLife.jpg">
<meta property="og:updated_time" content="2019-04-11T02:31:11.802Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java Multithreading">
<meta name="twitter:description" content="date: 2018-02-08 14:20:32 Description Thread: Each part of the program is called one Threads, and each thread defines an independent execution path.Multithreading is a special form of multitasking. Mu">
<meta name="twitter:image" content="https://feifaninternet.github.io/picture/ThreadLife.jpg">

  

  
    <link rel="icon" href="/picture/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbe6" rel="stylesheet">


  
    <link rel="stylesheet" href="/person/personal-style.css">
  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
</head>
</html>
<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">Site</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">Site</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a class="CIRCLE" href="/archives/" rel="noopener noreferrer" target="_self">
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a class="CIRCLE" href="/categories/JAVA" rel="noopener noreferrer" target="_self">
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a class="CIRCLE" href="/tags/git" rel="noopener noreferrer" target="_self">
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a class="CIRCLE" href="/link/" rel="noopener noreferrer" target="_self">
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a class="CIRCLE" href="/about/" rel="noopener noreferrer" target="_self">
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a class="CIRCLE" href="/atom.xml" rel="noopener noreferrer" target="_blank">
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a class="CIRCLE" href="/search/" rel="noopener noreferrer" target="_self">
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description"><span class="toc-text">Description</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Thread-Lift-Cycle"><span class="toc-text">Thread Lift Cycle</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Words"><span class="toc-text">Key Words</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thread’s-priority"><span class="toc-text">Thread’s priority</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Two-ways-to-create-a-thread"><span class="toc-text">Two ways to create a thread</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Implements-Runnable"><span class="toc-text">1.Implements Runnable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Extends-thread-class"><span class="toc-text">2.Extends thread class</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thread-class-method"><span class="toc-text">Thread class method</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Static-method"><span class="toc-text">Static method</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-of-the-main-concepts-in-threads"><span class="toc-text">Some of the main concepts in threads</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Thread-synchronization"><span class="toc-text">1.Thread synchronization</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Synchronization-method"><span class="toc-text">Synchronization method</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thread-Communication"><span class="toc-text">Thread Communication</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#nbsp-nbsp-Demand-Write-two-threads-one-thread-printing-1-52-another-thread-printing-letters-A-Z-print-order-12A34B56C-……-5152Z-requires-the-use-of-communication-between-threads"><span class="toc-text">  Demand: Write two threads, one thread printing 1 ~ 52, another thread printing letters A ~ Z, print order 12A34B56C …… 5152Z, requires the use of communication between threads.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-By-sharing-variables-to-achieve"><span class="toc-text">1.By sharing variables to achieve</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Use-the-most-basic-synchronized-notify-wait"><span class="toc-text">1.1 Use the most basic synchronized,notify,wait</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Use-Lock-and-Condition"><span class="toc-text">1.2 Use Lock and Condition</span></a></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-Java-Multithreading" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">Java Multithreading</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2019.04.11</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>xfan</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </span>



      
        <span>
          <i class="icon-comment"></i>
          <a href="https://feifaninternet.github.io//2019/04/11/Java-Multithreading/#disqus_thread"></a>
        </span>
      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <p>date: 2018-02-08 14:20:32</p>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><ol>
<li>Thread: Each part of the program is called one Threads, and each thread defines an independent execution path.Multithreading is a special form of multitasking. Multithreading requires less overhead than multitasking.   </li>
<li>Process: A process includes the memory space allocated by the operating system, including one or more threads. Threads can not exist independently, it must be part of the process. A process will run until all non-waiting threads end.</li>
</ol>
<h4 id="Thread-Lift-Cycle"><a href="#Thread-Lift-Cycle" class="headerlink" title="Thread Lift Cycle"></a>Thread Lift Cycle</h4><p><img src="/picture/ThreadLife.jpg" alt="Picture">   </p>
<h4 id="Key-Words"><a href="#Key-Words" class="headerlink" title="Key Words"></a>Key Words</h4><p>&nbsp;&nbsp;New state: A newly generated thread begins its life cycle from the new state. It stays in this state until the program starts this thread.</p>
<p>&nbsp;&nbsp;Running state: When a new state thread is started, the thread becomes runnable and the thread begins executing its task in this state.</p>
<p>&nbsp;&nbsp;Ready state: When a thread waiting for another thread to perform a task, the thread into the ready state. When another thread to the ready state,When the thread sends a signal, the thread switches back to running.</p>
<p>&nbsp;&nbsp;Sleep state: This thread goes to sleep from running due to the exhaustion of one thread’s time slice. When the time interval or waiting time expires.And, the state of the thread to switch to running.</p>
<p>&nbsp;&nbsp;Termination: A running state of the thread to complete the task or other termination conditions, the thread will switch to the termination of the state.</p>
<h3 id="Thread’s-priority"><a href="#Thread’s-priority" class="headerlink" title="Thread’s priority"></a>Thread’s priority</h3><p>&nbsp;&nbsp;Every Java thread has a priority, which helps the operating system to determine the thread’s scheduling order. Java priority is in MIN_PRIORITY (1) and MAX_PRIORITY (10) in the range between. By default, every thread is assigned a priority of NORM_PRIORITY (5).Threads with higher priority are more important to the program and should allocate processor time before the lower priority thread, but can not guarantee thread execution order and depend on the platform.</p>
<h3 id="Two-ways-to-create-a-thread"><a href="#Two-ways-to-create-a-thread" class="headerlink" title="Two ways to create a thread"></a>Two ways to create a thread</h3><ol>
<li>By implementing the Runnable interface.</li>
<li>By inheriting the Thread class itself.</li>
</ol>
<h4 id="1-Implements-Runnable"><a href="#1-Implements-Runnable" class="headerlink" title="1.Implements Runnable"></a>1.Implements Runnable</h4>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;  </span><br><span class="line">   Thread t;  </span><br><span class="line">   NewThread() &#123;  </span><br><span class="line">      <span class="comment">// Create a second new thread  </span></span><br><span class="line">      t = <span class="keyword">new</span> Thread(<span class="keyword">this</span>, <span class="string">"Demo Thread"</span>);  </span><br><span class="line">      System.out.println(<span class="string">"Child thread: "</span> + t);  </span><br><span class="line">      t.start();   </span><br><span class="line">   &#125;  </span><br><span class="line">  </span><br><span class="line">   <span class="comment">// The second thread entry </span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">      <span class="keyword">try</span> &#123;  </span><br><span class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">5</span>; i &gt; <span class="number">0</span>; i--) &#123;  </span><br><span class="line">            System.out.println(<span class="string">"Child Thread: "</span> + i);  </span><br><span class="line">            Thread.sleep(<span class="number">50</span>);  </span><br><span class="line">         &#125;  </span><br><span class="line">     &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </span><br><span class="line">         System.out.println(<span class="string">"Child interrupted"</span>);  </span><br><span class="line">     &#125;  </span><br><span class="line">     System.out.println(<span class="string">"Exiting child thread"</span>);  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> </span>&#123;  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;  </span><br><span class="line">      <span class="comment">// create a new thread </span></span><br><span class="line">      <span class="keyword">new</span> NewThread();   </span><br><span class="line">      <span class="keyword">try</span> &#123;  </span><br><span class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">5</span>; i &gt; <span class="number">0</span>; i--) &#123;  </span><br><span class="line">           System.out.println(<span class="string">"Main Thread: "</span> + i);  </span><br><span class="line">           Thread.sleep(<span class="number">100</span>);  </span><br><span class="line">         &#125;  </span><br><span class="line">      &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </span><br><span class="line">         System.out.println(<span class="string">"Main thread interrupted"</span>);  </span><br><span class="line">      &#125;  </span><br><span class="line">      System.out.println(<span class="string">"Main thread exiting"</span>);  </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-Extends-thread-class"><a href="#2-Extends-thread-class" class="headerlink" title="2.Extends thread class"></a>2.Extends thread class</h4>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;  </span><br><span class="line">   NewThread() &#123;  </span><br><span class="line">      <span class="comment">// Create a second new thread   </span></span><br><span class="line">      <span class="keyword">super</span>(<span class="string">"Demo Thread"</span>);  </span><br><span class="line">      System.out.println(<span class="string">"Child thread: "</span> + <span class="keyword">this</span>);  </span><br><span class="line">      start();   </span><br><span class="line">   &#125;  </span><br><span class="line">    </span><br><span class="line">   <span class="comment">// The second thread entry </span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">      <span class="keyword">try</span> &#123;  </span><br><span class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">5</span>; i &gt; <span class="number">0</span>; i--) &#123;  </span><br><span class="line">            System.out.println(<span class="string">"Child Thread: "</span> + i);  </span><br><span class="line">            Thread.sleep(<span class="number">50</span>);  </span><br><span class="line">         &#125;  </span><br><span class="line">      &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </span><br><span class="line">         System.out.println(<span class="string">"Child interrupted."</span>);  </span><br><span class="line">      &#125;  </span><br><span class="line">      System.out.println(<span class="string">"Exiting child thread."</span>);  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExtendsThread</span> </span>&#123;  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;  </span><br><span class="line">      <span class="comment">// create a new thread </span></span><br><span class="line">      <span class="keyword">new</span> NewThread();   </span><br><span class="line">      <span class="keyword">try</span> &#123;  </span><br><span class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">5</span>; i &gt; <span class="number">0</span>; i--) &#123;  </span><br><span class="line">            System.out.println(<span class="string">"Main Thread: "</span> + i);  </span><br><span class="line">            Thread.sleep(<span class="number">100</span>);  </span><br><span class="line">         &#125;  </span><br><span class="line">      &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </span><br><span class="line">         System.out.println(<span class="string">"Main thread interrupted."</span>);  </span><br><span class="line">      &#125;  </span><br><span class="line">      System.out.println(<span class="string">"Main thread exiting."</span>);  </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">output:</span><br><span class="line">    Child thread: Thread[Demo Thread, 5, main]</span><br><span class="line">    Main Thread: 5</span><br><span class="line">    Child Thread: 5</span><br><span class="line">    Child Thread: 4</span><br><span class="line">    Main Thread: 4</span><br><span class="line">    Child Thread: 3</span><br><span class="line">    Child Thread: 2</span><br><span class="line">    Main Thread: 3</span><br><span class="line">    Child Thread: 1</span><br><span class="line">    Exiting child thread</span><br><span class="line">    Main Thread: 2</span><br><span class="line">    Main Thread: 1</span><br><span class="line">    Main thread exiting</span><br></pre></td></tr></table></figure>
<h3 id="Thread-class-method"><a href="#Thread-class-method" class="headerlink" title="Thread class method"></a>Thread class method</h3><ol>
<li><p>Executed using this thread</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public void start()</span><br></pre></td></tr></table></figure>
</li>
<li><p>Runnable object’s run method</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public void run()</span><br></pre></td></tr></table></figure>
</li>
<li><p>Change the name of the thread to the same name as the parameter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public final void setName(String name)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Change the priority of the thread</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public final void setPriority(int priority)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Mark this thread as a daemon or user thread</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public final void setDaemon(boolean on)</span><br></pre></td></tr></table></figure>
</li>
<li><p>The maximum time to wait for this thread to expire is sec milliseconds</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public final void join(long sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Interrupt thread</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public void interrupt()</span><br></pre></td></tr></table></figure>
</li>
<li><p>Test whether the thread is active</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public final boolean isAlive()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="Static-method"><a href="#Static-method" class="headerlink" title="Static method"></a>Static method</h4><ol>
<li><p>Suspend the current thread and execute other threads</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static void yield()</span><br></pre></td></tr></table></figure>
</li>
<li><p>Sleep sec milliseconds</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static void sleep(long sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p>True if and only if the current thread is holding the monitor lock on the specified object</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static boolean holdsLock(Object obj)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Returns a reference to the currently executing thread object</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static Thread currentThread()</span><br></pre></td></tr></table></figure>
</li>
<li><p>Print the current thread’s stack trace to the standard error stream</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static void dumpStack()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Some-of-the-main-concepts-in-threads"><a href="#Some-of-the-main-concepts-in-threads" class="headerlink" title="Some of the main concepts in threads"></a>Some of the main concepts in threads</h3><h3 id="1-Thread-synchronization"><a href="#1-Thread-synchronization" class="headerlink" title="1.Thread synchronization"></a>1.Thread synchronization</h3><p>&nbsp;&nbsp;Having multiple threads accessing a variable or object at the same time, having both read and write operations in those threads can cause confusion in the value of the variable or the state of the object, causing the program to become abnormal. So add a synchronization lock to avoid being called by other threads before the thread has not completed the operation, thus ensuring the uniqueness and accuracy of the variable or object.</p>
<h4 id="Synchronization-method"><a href="#Synchronization-method" class="headerlink" title="Synchronization method"></a>Synchronization method</h4><ol>
<li><p>Use the synchronized keyword modification method</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bank</span> </span>&#123;  </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// balance</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// save money  </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">addMoney</span><span class="params">(<span class="keyword">int</span> money)</span></span>&#123;  </span><br><span class="line">        count += money;  </span><br><span class="line">        System.out.println(System.currentTimeMillis() + <span class="string">"Save："</span> + money);  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// take out money  </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">subMoney</span><span class="params">(<span class="keyword">int</span> money)</span></span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(count - money &lt; <span class="number">0</span>)&#123;  </span><br><span class="line">            System.out.println(<span class="string">"Insufficient balance"</span>);  </span><br><span class="line">            <span class="keyword">return</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">        count -= money;  </span><br><span class="line">        System.out.println(+System.currentTimeMillis() + <span class="string">"Take："</span>+money);  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// select  </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lookMoney</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">"Balance："</span> + count);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SyncThreadTest</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;  </span><br><span class="line">        <span class="keyword">final</span> Bank bank = <span class="keyword">new</span> Bank();  </span><br><span class="line"></span><br><span class="line">        Thread threadAdd = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;  </span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span>  </span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">                <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">                <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;  </span><br><span class="line">                    <span class="keyword">try</span> &#123;  </span><br><span class="line">                        Thread.sleep(<span class="number">1000</span>);  </span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </span><br><span class="line">                        <span class="comment">// TODO Auto-generated catch block  </span></span><br><span class="line">                        e.printStackTrace();  </span><br><span class="line">                    &#125;  </span><br><span class="line">                    bank.addMoney(<span class="number">100</span>);  </span><br><span class="line">                    bank.lookMoney();  </span><br><span class="line">                    System.out.println(<span class="string">"\n"</span>);  </span><br><span class="line"></span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;);  </span><br><span class="line"></span><br><span class="line">        Thread threadSub = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;  </span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span>  </span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">                <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">                <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;  </span><br><span class="line">                    bank.subMoney(<span class="number">100</span>);  </span><br><span class="line">                    bank.lookMoney();  </span><br><span class="line">                    System.out.println(<span class="string">"\n"</span>);  </span><br><span class="line">                    <span class="keyword">try</span> &#123;  </span><br><span class="line">                        Thread.sleep(<span class="number">1000</span>);  </span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </span><br><span class="line">                        <span class="comment">// TODO Auto-generated catch block  </span></span><br><span class="line">                        e.printStackTrace();  </span><br><span class="line">                    &#125;     </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;);  </span><br><span class="line">        threadSub.start();   </span><br><span class="line">        threadAdd.start();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Use special domain variables (volatile) to achieve thread synchronization</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">private volatile int count = 0;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>&nbsp;&nbsp;a. The volatile keyword provides a lock-free mechanism for accessing domain variables   </p>
<p>&nbsp;&nbsp;b. The use of volatile modified domain is equivalent to tell the virtual machine that the domain may be updated by other threads   </p>
<p>&nbsp;&nbsp;c. Instead of using the value in the register each time you use this field, recalculate   </p>
<p>&nbsp;&nbsp;d. Volatile does not provide any atomic operations, it can not be used to modify final type variables   </p>
<p>&nbsp;&nbsp;Its principle is to read the volatile modified variables every time the thread is read from memory, rather than read the cache, so each thread to access the variable values ​​are the same. This ensures synchronization.Not recommended.</p>
<p>3.Use re-lock to achieve thread synchronization<br>&nbsp;&nbsp;The ReentrantLock class is a reentrant, mutually exclusive, lock that implements the Lock interface, which has the same basic behavior and semantics as the synchronized method, and extends its capabilities.<br>&nbsp;&nbsp;ReentrantLock commonly used methods:   </p>
<ul>
<li><p>Create an ReentrantLock instance</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ReentrantLock()</span><br></pre></td></tr></table></figure>
</li>
<li><p>Get lock</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lock()</span><br></pre></td></tr></table></figure>
</li>
<li><p>Release lock</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unlock()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Example<br>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bank</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// declare ReentrantLock</span></span><br><span class="line">    <span class="keyword">private</span> Lock lock = <span class="keyword">new</span> ReentrantLock();  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addMoney</span><span class="params">(<span class="keyword">int</span> money)</span> </span>&#123;  </span><br><span class="line">        <span class="comment">// lock</span></span><br><span class="line">        lock.lock(); </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>&#123;                </span><br><span class="line">            count += money;  </span><br><span class="line">            System.out.println(System.currentTimeMillis() + <span class="string">"Save："</span> + money);  </span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;  </span><br><span class="line">            <span class="comment">// release</span></span><br><span class="line">            lock.unlock(); </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subMoney</span><span class="params">(<span class="keyword">int</span> money)</span> </span>&#123;  </span><br><span class="line">        lock.lock();  </span><br><span class="line">        <span class="keyword">try</span>&#123;  </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (count - money &lt; <span class="number">0</span>) &#123;  </span><br><span class="line">            System.out.println(<span class="string">"Insufficient balance"</span>);  </span><br><span class="line">            <span class="keyword">return</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">        count -= money;  </span><br><span class="line">        System.out.println(+System.currentTimeMillis() + <span class="string">"Take："</span> + money);  </span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;  </span><br><span class="line">            lock.unlock();  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lookMoney</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">"Balance："</span> + count);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>4.Use local variables for thread synchronization<br>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bank</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;Integer&gt; count = <span class="keyword">new</span> ThreadLocal&lt;Integer&gt;()&#123;  </span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span>  </span><br><span class="line">        <span class="function"><span class="keyword">protected</span> Integer <span class="title">initialValue</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">            <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line"></span><br><span class="line">    &#125;;  </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addMoney</span><span class="params">(<span class="keyword">int</span> money)</span> </span>&#123;  </span><br><span class="line">        count.set(count.get()+money);  </span><br><span class="line">        System.out.println(System.currentTimeMillis() + <span class="string">"Save："</span> + money);  </span><br><span class="line"></span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subMoney</span><span class="params">(<span class="keyword">int</span> money)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">if</span> (count.get() - money &lt; <span class="number">0</span>) &#123;  </span><br><span class="line">            System.out.println(<span class="string">"Insufficient balance"</span>);  </span><br><span class="line">            <span class="keyword">return</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">        count.set(count.get()- money);  </span><br><span class="line">        System.out.println(+System.currentTimeMillis() + <span class="string">"Take："</span> + money);  </span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lookMoney</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">"Balance："</span> + count.get());  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;When using ThreadLocal to manage variables, each thread that uses the variable gets a copy of the variable, independent of each other, so that each thread is free to modify its own copy of the variable without affecting other threads.</p>
<h3 id="Thread-Communication"><a href="#Thread-Communication" class="headerlink" title="Thread Communication"></a>Thread Communication</h3><h4 id="nbsp-nbsp-Demand-Write-two-threads-one-thread-printing-1-52-another-thread-printing-letters-A-Z-print-order-12A34B56C-……-5152Z-requires-the-use-of-communication-between-threads"><a href="#nbsp-nbsp-Demand-Write-two-threads-one-thread-printing-1-52-another-thread-printing-letters-A-Z-print-order-12A34B56C-……-5152Z-requires-the-use-of-communication-between-threads" class="headerlink" title="&nbsp;&nbsp;Demand: Write two threads, one thread printing 1 ~ 52, another thread printing letters A ~ Z, print order 12A34B56C …… 5152Z, requires the use of communication between threads."></a>&nbsp;&nbsp;Demand: Write two threads, one thread printing 1 ~ 52, another thread printing letters A ~ Z, print order 12A34B56C …… 5152Z, requires the use of communication between threads.</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Auxiliary tools</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">enum</span> HelpUtil &#123;</span><br><span class="line">     instance;</span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ExecutorService tPool = Executors.newFixedThreadPool(<span class="number">2</span>);</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">static</span> String[] buildNumArr(<span class="keyword">int</span> max)&#123;</span><br><span class="line">         String[] numArr = <span class="keyword">new</span> String[max];</span><br><span class="line">         <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; max; i++)&#123;</span><br><span class="line">             numArr[i] = Integer.toString(i + <span class="number">1</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> numArr;</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">static</span> String[] buildCharArr(<span class="keyword">int</span> max)&#123;</span><br><span class="line">         String[] charArr = <span class="keyword">new</span> String[max];</span><br><span class="line">         <span class="keyword">int</span> temp = <span class="number">65</span>;</span><br><span class="line">         <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; max; i++)&#123;</span><br><span class="line">             charArr[i] = String.valueOf((<span class="keyword">char</span>)(temp + i));</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> charArr;</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(String... input)</span></span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (input == <span class="keyword">null</span>)&#123;</span><br><span class="line">             <span class="keyword">return</span>;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">for</span> (String each : input)&#123;</span><br><span class="line">             System.out.print(each + <span class="string">" "</span>);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(Runnable r)</span></span>&#123;</span><br><span class="line">         tPool.submit(r);</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span></span>&#123;</span><br><span class="line">         tPool.shutdown();</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-By-sharing-variables-to-achieve"><a href="#1-By-sharing-variables-to-achieve" class="headerlink" title="1.By sharing variables to achieve"></a>1.By sharing variables to achieve</h3><h3 id="1-1-Use-the-most-basic-synchronized-notify-wait"><a href="#1-1-Use-the-most-basic-synchronized-notify-wait" class="headerlink" title="1.1 Use the most basic synchronized,notify,wait"></a>1.1 Use the most basic synchronized,notify,wait</h3>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MethodOne</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 3.Use volatile</span></span><br><span class="line"><span class="comment">    * 4.Use AtomicInteger</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ThreadToGo</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> value = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ThreadToGo threadToGo = <span class="keyword">new</span> ThreadToGo();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Runnable <span class="title">newThreadOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">final</span> String[] numArrInit = HelpUtil.buildNumArr(<span class="number">52</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="keyword">private</span> String[] numArr = numArrInit;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; numArr.length; i = i+<span class="number">2</span>)&#123;</span><br><span class="line">                        <span class="keyword">synchronized</span> (threadToGo)&#123;</span><br><span class="line">                            <span class="keyword">while</span> (threadToGo.value == <span class="number">2</span>)&#123;</span><br><span class="line">                                threadToGo.wait();</span><br><span class="line">                            &#125;</span><br><span class="line">                            HelpUtil.print(numArr[i],numArr[i + <span class="number">1</span>]);</span><br><span class="line">                            threadToGo.value = <span class="number">2</span>;</span><br><span class="line">                            threadToGo.notify();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">                    System.out.println(<span class="string">"Oops...."</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Runnable <span class="title">newThreadTwo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">final</span> String[] charArrInit = HelpUtil.buildCharArr(<span class="number">26</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="keyword">private</span> String[] charArr = charArrInit;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; charArr.length; i++)&#123;</span><br><span class="line">                        <span class="keyword">synchronized</span> (threadToGo)&#123;</span><br><span class="line">                            <span class="keyword">while</span> (threadToGo.value == <span class="number">1</span>)&#123;</span><br><span class="line">                                threadToGo.wait();</span><br><span class="line">                            &#125;</span><br><span class="line">                            HelpUtil.print(charArr[i]);</span><br><span class="line">                            threadToGo.value = <span class="number">1</span>;</span><br><span class="line">                            threadToGo.notify();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">                    System.out.println(<span class="string">"Oops...."</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MethodOne one = <span class="keyword">new</span> MethodOne();</span><br><span class="line">        HelpUtil.instance.run(one.newThreadOne());</span><br><span class="line">        HelpUtil.instance.run(one.newThreadTwo());</span><br><span class="line">        HelpUtil.instance.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-2-Use-Lock-and-Condition"><a href="#1-2-Use-Lock-and-Condition" class="headerlink" title="1.2 Use Lock and Condition"></a>1.2 Use Lock and Condition</h3>
    
  </div>

  
      <div class="git"></div>
  

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持xfan</div>
        <ul>
        
          <li class="item">
            <span>微信扫一扫</span>
            <img src="/picture/qr-wechat.png" alt>
          </li>
        
          <li class="item">
            <span>支付宝扫一扫</span>
            <img src="/picture/qr-alipay.png" alt>
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2019/04/11/MongoDB/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2019/04/11/Java-Queue/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/archives/" rel="noopener noreferrer" target="_self">
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/categories/JAVA" rel="noopener noreferrer" target="_self">
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/tags/git" rel="noopener noreferrer" target="_self">
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/link/" rel="noopener noreferrer" target="_self">
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/about/" rel="noopener noreferrer" target="_self">
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/atom.xml" rel="noopener noreferrer" target="_blank">
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/search/" rel="noopener noreferrer" target="_self">
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    
  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'xfan';
    
    var disqus_url = 'https://feifaninternet.github.io/2019/04/11/Java-Multithreading/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script id="dsq-count-scr" src="//xfan.disqus.com/count.js" async></script>



    
    

    
    

    

    
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
